<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Bus Announcer</title>
    <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            text-align: center;
            background-color: #eef2f3;
            margin: 0;
            padding: 20px;
        }
        h1 { color: #d32f2f; }
        #reader {
            width: 300px;
            margin: 0 auto;
            border: 5px solid #333;
            border-radius: 10px;
            background-color: #000;
        }
        #status {
            margin-top: 20px;
            font-size: 18px;
            font-weight: bold;
            color: #00796b;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .btn {
            background-color: #008CBA;
            color: white;
            padding: 15px 32px;
            text-align: center;
            font-size: 16px;
            margin-top: 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            box-shadow: 0 4px #999;
        }
    </style>
</head>
<body>

    <h1>üöç Smart Bus Station</h1>
    <div id="reader"></div>
    <div id="status">Waiting for Bus...</div>
    <button class="btn" onclick="startScanner()">Camera On Karo</button>

    <script>
        // YAHAN AAP APNI MARZI SE STOPS AUR TIME BADAL SAKTE HAIN
        const busData = {
            "BUS_101": {
                hindi: "‡§ï‡•É‡§™‡§Ø‡§æ ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç. ‡§¨‡§∏ ‡§®‡§Ç‡§¨‡§∞ 101 ‡§Ü ‡§ó‡§Ø‡•Ä ‡§π‡•à. ‡§Ø‡§π ‡§Æ‡•Å‡§Ç‡§¨‡§à ‡§∏‡•á ‡§¶‡§ø‡§≤‡•ç‡§≤‡•Ä ‡§ú‡§æ‡§è‡§ó‡•Ä. ‡§Ø‡§π ‡§∞‡§æ‡§∏‡•ç‡§§‡•á ‡§Æ‡•á‡§Ç ‡§∏‡•Ç‡§∞‡§§, ‡§µ‡§°‡•ã‡§¶‡§∞‡§æ ‡§î‡§∞ ‡§ú‡§Ø‡§™‡•Å‡§∞ ‡§∞‡•Å‡§ï‡•á‡§ó‡•Ä. ‡§Ø‡§π ‡§Ü‡§™‡§ï‡•ã ‡§ï‡§≤ ‡§∏‡•Å‡§¨‡§π 10 ‡§¨‡§ú‡•á ‡§¶‡§ø‡§≤‡•ç‡§≤‡•Ä ‡§õ‡•ã‡•ú‡•á‡§ó‡•Ä.",
                english: "Attention please. Bus number 101 has arrived. It is going from Mumbai to Delhi. It will stop at Surat, Vadodara, and Jaipur. It will reach Delhi tomorrow at 10 AM."
            },
            "BUS_102": {
                hindi: "‡§¨‡§∏ ‡§®‡§Ç‡§¨‡§∞ 102 ‡§Ü ‡§ó‡§Ø‡•Ä ‡§π‡•à. ‡§Ø‡§π ‡§Ö‡§Ç‡§ß‡•á‡§∞‡•Ä ‡§∏‡•á ‡§¨‡§æ‡§Ç‡§¶‡•ç‡§∞‡§æ ‡§ú‡§æ‡§è‡§ó‡•Ä. ‡§Ø‡§π ‡§¨‡•Ä‡§ö ‡§Æ‡•á‡§Ç ‡§ú‡•Å‡§π‡•Ç ‡§î‡§∞ ‡§∏‡§æ‡§Ç‡§§‡§æ‡§ï‡•ç‡§∞‡•Ç‡§ú‡§º ‡§∞‡•Å‡§ï‡•á‡§ó‡•Ä. ‡§Ø‡§π 45 ‡§Æ‡§ø‡§®‡§ü ‡§Æ‡•á‡§Ç ‡§¨‡§æ‡§Ç‡§¶‡•ç‡§∞‡§æ ‡§™‡§π‡•Å‡§Å‡§ö‡§æ ‡§¶‡•á‡§ó‡•Ä.",
                english: "Bus number 102 has arrived. It is going from Andheri to Bandra. It will stop at Juhu and Santacruz. It will reach Bandra in 45 minutes."
            }
        };

        let lastScanned = "";
        let isSpeaking = false;

        function onScanSuccess(decodedText, decodedResult) {
            if (decodedText === lastScanned || isSpeaking) return;
            
            lastScanned = decodedText;
            
            if (busData[decodedText]) {
                // Screen par likha hua dikhana
                document.getElementById('status').innerHTML = 
                    "‚úÖ <b>Bus Found!</b><br>" + 
                    "Route: Mumbai ‚ûù Delhi<br>" + 
                    "Stops: Surat, Jaipur<br>" + 
                    "Time: 10:00 AM Drop";
                
                speakDual(busData[decodedText].hindi, busData[decodedText].english);
            } else {
                document.getElementById('status').innerText = "Unknown Bus: " + decodedText;
                speakDual("‡§Ø‡§π ‡§¨‡§∏ ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§Æ‡•á‡§Ç ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à.", "This bus is not registered.");
            }
        }

        function onScanFailure(error) {
            // Error ignore karein
        }

        function startScanner() {
            document.getElementById('status').innerText = "Scanning shuru ho rahi hai...";
            let html5QrcodeScanner = new Html5QrcodeScanner(
                "reader", 
                { fps: 10, qrbox: {width: 250, height: 250} },
                /* verbose= */ false);
            html5QrcodeScanner.render(onScanSuccess, onScanFailure);
        }

        function speakDual(hindiText, englishText) {
            isSpeaking = true;

            let msgHi = new SpeechSynthesisUtterance(hindiText);
            msgHi.lang = 'hi-IN'; 
            msgHi.rate = 0.9;
            
            let msgEn = new SpeechSynthesisUtterance(englishText);
            msgEn.lang = 'en-IN'; 
            msgEn.rate = 0.9;

            msgEn.onend = function() {
                isSpeaking = false;
                lastScanned = ""; 
                document.getElementById('status').innerText = "Next Bus ka intezaar...";
            };

            window.speechSynthesis.cancel();
            window.speechSynthesis.speak(msgHi);
            window.speechSynthesis.speak(msgEn);
        }
    </script>

</body>
</html>
