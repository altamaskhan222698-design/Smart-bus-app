<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Station Master Pro</title>
    <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&display=swap" rel="stylesheet">
    
    <style>
        body {
            background-color: #000;
            color: white;
            font-family: 'Segoe UI', sans-serif;
            text-align: center;
            margin: 0;
            padding: 0;
            overflow: hidden; /* Scroll band */
        }

        /* --- 1. SCANNING SCREEN (Normal Mode) --- */
        #scan-screen {
            padding: 20px;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .header {
            font-family: 'Orbitron', sans-serif;
            font-size: 24px;
            color: #ffab00;
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 2px;
            border-bottom: 2px solid #333;
            width: 100%;
            padding-bottom: 10px;
        }

        #reader {
            width: 100%;
            max-width: 400px;
            border: 4px solid #ffab00;
            border-radius: 15px;
            box-shadow: 0 0 20px rgba(255, 171, 0, 0.3);
        }

        .btn {
            background: linear-gradient(45deg, #d32f2f, #b71c1c);
            color: white;
            padding: 15px 40px;
            font-size: 20px;
            border: none;
            border-radius: 50px;
            margin-top: 30px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(255, 0, 0, 0.4);
            font-weight: bold;
        }

        /* --- 2. FULL SCREEN BOARD (Magic Mode) --- */
        #big-board {
            display: none; /* Pehle chhupa rahega */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: black;
            z-index: 9999;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            box-sizing: border-box;
            border: 10px solid #222;
        }

        .board-header {
            font-family: 'Orbitron', sans-serif;
            color: #00e676; /* Green */
            font-size: 2vw; /* Responsive size */
            margin-bottom: 20px;
        }

        .big-bus-no {
            font-family: 'Orbitron', sans-serif;
            font-size: 15vw; /* Bahut Bada Text */
            color: #ff3d00; /* Red Neon */
            font-weight: 900;
            text-shadow: 0 0 30px #ff3d00;
            margin: 10px 0;
        }

        .big-route {
            font-family: 'Orbitron', sans-serif;
            font-size: 5vw;
            color: #ffeb3b; /* Yellow */
            margin-top: 20px;
            text-transform: uppercase;
        }

        .big-stops {
            font-size: 3vw;
            color: white;
            margin-top: 20px;
            opacity: 0.8;
        }

        /* Blinking Effect for "Departure" */
        .blink { animation: blinker 1s linear infinite; color: red; margin-top: 30px; font-size: 3vw; font-weight: bold;}
        @keyframes blinker { 50% { opacity: 0; } }

    </style>
</head>
<body>

    <div id="scan-screen">
        <div class="header">üö¶ Smart Bus Control</div>
        <div id="reader"></div>
        <div id="status" style="color:#888; margin-top:10px;">Waiting for Bus...</div>
        
        <div style="margin-top:20px;">
            <button class="btn" onclick="startScanner()">CAMERA ON</button>
            <button class="btn" style="background:#0288d1; font-size:16px; padding:10px 20px;" onclick="testVoice()">Test Sound</button>
        </div>
    </div>

    <div id="big-board">
        <div class="board-header">‚óè NOW BOARDING ‚óè</div>
        <div id="showBusNo" class="big-bus-no">BUS 101</div>
        <div id="showRoute" class="big-route">MUMBAI ‚ûù DELHI</div>
        <div id="showStops" class="big-stops">Via: Surat, Jaipur</div>
        <div class="blink">‚ö† DEPARTING SOON ‚ö†</div>
    </div>

    <script>
        // --- 5 BUS DATA ---
        const busData = {
            "BUS_101": {
                hindi: "‡§°‡§ø‡§Ç‡§ó ‡§°‡•ã‡§Ç‡§ó... ‡§Ø‡§æ‡§§‡•ç‡§∞‡•Ä‡§ó‡§£ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç. ‡§¨‡§∏ ‡§®‡§Ç‡§¨‡§∞ 101, ‡§®‡§æ‡§ó‡§™‡•Å‡§∞ ‡§∏‡•á ‡§Æ‡•Å‡§Ç‡§¨‡§à ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡•ç‡§≤‡•á‡§ü‡§´‡§æ‡§∞‡•ç‡§Æ ‡§™‡§∞ ‡§Ü ‡§ó‡§Ø‡•Ä ‡§π‡•à.",
                english: "May I have your attention please. Bus number 101, Nagpur to Mumbai, has arrived.",
                route: "NAGPUR ‚ûù MUMBAI",
                stops: "Via: Amravati ‚Ä¢ Aurangabad"
            },
            "BUS_102": {
                hindi: "‡§Ø‡§æ‡§§‡•ç‡§∞‡•Ä‡§ó‡§£ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç. ‡§¨‡§∏ ‡§®‡§Ç‡§¨‡§∞ 102, ‡§Æ‡•Å‡§Ç‡§¨‡§à ‡§∏‡•á ‡§¶‡§ø‡§≤‡•ç‡§≤‡•Ä ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü ‡§ó‡§Ø‡•Ä ‡§π‡•à.",
                english: "Attention please. Bus number 102, Mumbai to Delhi, has arrived.",
                route: "MUMBAI ‚ûù DELHI",
                stops: "Via: Ahmedabad ‚Ä¢ Jaipur"
            },
            "BUS_103": {
                hindi: "‡§Ø‡§æ‡§§‡•ç‡§∞‡•Ä‡§ó‡§£ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç. ‡§¨‡§∏ ‡§®‡§Ç‡§¨‡§∞ 103, ‡§Ö‡§π‡§Æ‡§¶‡§æ‡§¨‡§æ‡§¶ ‡§∏‡•á ‡§≤‡§ñ‡§®‡§ä ‡§ú‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§π‡•à.",
                english: "Attention please. Bus number 103, Ahmedabad to Lucknow, is departing.",
                route: "AHMEDABAD ‚ûù LUCKNOW",
                stops: "Via: Bhopal ‚Ä¢ Kanpur"
            },
            "BUS_104": {
                hindi: "‡§Ø‡§æ‡§§‡•ç‡§∞‡•Ä‡§ó‡§£ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç. ‡§¨‡§∏ ‡§®‡§Ç‡§¨‡§∞ 104, ‡§¶‡§ø‡§≤‡•ç‡§≤‡•Ä ‡§∏‡•á ‡§ï‡•ã‡§≤‡§ï‡§æ‡§§‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü ‡§ó‡§Ø‡•Ä ‡§π‡•à.",
                english: "Attention please. Bus number 104, Delhi to Kolkata, has arrived.",
                route: "DELHI ‚ûù KOLKATA",
                stops: "Via: Agra ‚Ä¢ Varanasi"
            },
            "BUS_105": {
                hindi: "‡§Ø‡§æ‡§§‡•ç‡§∞‡•Ä‡§ó‡§£ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç. ‡§¨‡§∏ ‡§®‡§Ç‡§¨‡§∞ 105, ‡§™‡•Å‡§£‡•á ‡§∏‡•á ‡§¨‡•à‡§Ç‡§ó‡§≤‡•ã‡§∞ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü ‡§ó‡§Ø‡•Ä ‡§π‡•à.",
                english: "Attention please. Bus number 105, Pune to Bangalore, has arrived.",
                route: "PUNE ‚ûù BANGALORE",
                stops: "Via: Kolhapur ‚Ä¢ Belgaum"
            }
        };

        let isSpeaking = false;
        let lastScanned = "";

        function onScanSuccess(decodedText) {
            if (isSpeaking || decodedText === lastScanned) return;

            if (busData[decodedText]) {
                lastScanned = decodedText;
                const bus = busData[decodedText];

                // 1. SWITCH TO BIG SCREEN MODE
                showBigBoard(decodedText, bus);

                // 2. PLAY AUDIO
                playAnnouncement(bus.hindi, bus.english);
            }
        }

        function showBigBoard(code, bus) {
            // Camera screen chupao
            document.getElementById('scan-screen').style.display = 'none';
            // Badi screen dikhao
            const board = document.getElementById('big-board');
            board.style.display = 'flex';
            
            // Data set karo
            document.getElementById('showBusNo').innerText = "BUS " + code.split('_')[1];
            document.getElementById('showRoute').innerText = bus.route;
            document.getElementById('showStops').innerText = bus.stops;
        }

        function hideBigBoard() {
            // Wapas Camera screen par aao
            document.getElementById('big-board').style.display = 'none';
            document.getElementById('scan-screen').style.display = 'flex';
            document.getElementById('status').innerText = "Ready for Next Bus...";
        }

        function playAnnouncement(hi, en) {
            isSpeaking = true;
            window.speechSynthesis.cancel();

            let chime = new SpeechSynthesisUtterance("Tring Tring");
            chime.lang = 'hi-IN'; chime.rate = 1.2; chime.pitch = 1.4;

            let msgHi = new SpeechSynthesisUtterance(hi);
            msgHi.lang = 'hi-IN'; msgHi.rate = 0.85;

            let msgEn = new SpeechSynthesisUtterance(en);
            msgEn.lang = 'en-IN'; msgEn.rate = 0.85;

            // Sequence: Chime -> Hindi -> English -> Back to Camera
            chime.onend = () => { window.speechSynthesis.speak(msgHi); };
            msgHi.onend = () => { window.speechSynthesis.speak(msgEn); };
            msgEn.onend = () => { 
                isSpeaking = false; 
                lastScanned = ""; 
                setTimeout(hideBigBoard, 2000); // 2 second baad screen wapas normal hogi
            };

            window.speechSynthesis.speak(chime);
        }

        function startScanner() {
            const scanner = new Html5QrcodeScanner("reader", { fps: 10, qrbox: 250 });
            scanner.render(onScanSuccess);
            document.getElementById('status').innerText = "Scanning Active...";
        }

        function testVoice() {
            let u = new SpeechSynthesisUtterance("Sound Check OK");
            window.speechSynthesis.speak(u);
        }
    </script>
</body>
</html>
